{% extends "base.html" %}
{% block title %}Setores - Print Monitor{% endblock %}

{% block content %}
<h2>Setores</h2>

<form class="row gy-2 gx-3 align-items-center mb-3" method="get" action="{{ url_for('painel_setores') }}">
  <div class="col-auto">
    <input type="date" name="start_date" class="form-control" placeholder="Data Início" value="{{ start_date }}">
  </div>
  <div class="col-auto">
    <input type="date" name="end_date" class="form-control" placeholder="Data Fim" value="{{ end_date }}">
  </div>
  <div class="col-auto">
    <input type="text" name="filtro_setor" class="form-control" placeholder="Filtro Setor" value="{{ filtro_setor }}">
  </div>
  <div class="col-auto">
    <button type="submit" class="btn btn-primary">Filtrar</button>
    <a href="{{ url_for('export_setores_excel', start_date=start_date, end_date=end_date, filtro_setor=filtro_setor) }}" class="btn btn-outline-success ms-2">Exportar Excel</a>
  </div>
</form>

<div class="table-responsive">
  <table class="table table-striped table-hover table-dark align-middle">
    <thead>
      <tr>
        <th>Setor</th>
        <th>Total Impressões</th>
        <th>Total Páginas</th>
        <th>Valor Estimado</th>
      </tr>
    </thead>
    <tbody>
      {% for setor in setores %}
      <tr>
        <td>{{ setor['sector'] }}</td>
        <td>{{ setor['total_impressos'] }}</td>
        <td>{{ setor['total_paginas'] }}</td>
        <td>R$ {{ "%.2f"|format(setor['valor_estimado'] or 0) }}</td>
      </tr>
      {% else %}
      <tr>
        <td colspan="4" class="text-center">Nenhum registro encontrado.</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>
{% endblock %}
