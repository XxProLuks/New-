{% extends "base.html" %}
{% block title %}Usuários - Print Monitor{% endblock %}

{% block content %}
<h2>Usuários</h2>

<form class="row gy-2 gx-3 align-items-center mb-3" method="get" action="{{ url_for('all_users') }}">
  <div class="col-auto">
    <input type="date" name="start_date" class="form-control" placeholder="Data Início" value="{{ start_date }}">
  </div>
  <div class="col-auto">
    <input type="date" name="end_date" class="form-control" placeholder="Data Fim" value="{{ end_date }}">
  </div>
  <div class="col-auto">
    <input type="text" name="filtro_usuario" class="form-control" placeholder="Filtro Usuário" value="{{ filtro_usuario }}">
  </div>
  <div class="col-auto">
    <button type="submit" class="btn btn-primary">Filtrar</button>
    <a href="{{ url_for('export_usuarios_excel', start_date=start_date, end_date=end_date, filtro_usuario=filtro_usuario) }}" class="btn btn-outline-success ms-2">Exportar Excel</a>
  </div>
</form>

<div class="table-responsive">
  <table class="table table-striped table-hover table-dark align-middle">
    <thead>
      <tr>
        <th>Usuário</th>
        <th>Máquina</th>
        <th>Total Impressões</th>
        <th>Total Páginas</th>
      </tr>
    </thead>
    <tbody>
      {% for user, machine, total_imp, total_pag in data %}
      <tr>
        <td>{{ user }}</td>
        <td>{{ machine }}</td>
        <td>{{ total_imp }}</td>
        <td>{{ total_pag }}</td>
      </tr>
      {% else %}
      <tr>
        <td colspan="4" class="text-center">Nenhum registro encontrado.</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>
{% endblock %}
