{% extends "base.html" %}
{% block title %}Admin Logins - Print Monitor{% endblock %}
{% block content %}
<h2>Administração de Logins</h2>

{% if message %}
<div class="alert alert-info">{{ message }}</div>
{% endif %}

<table class="table table-hover table-dark align-middle">
  <thead>
    <tr>
      <th>Usuário</th>
      <th>Administrador</th>
      <th>Ações</th>
    </tr>
  </thead>
  <tbody>
    {% for usuario, is_admin in usuarios %}
    <tr>
      <td>{{ usuario }}</td>
      <td>{{ "Sim" if is_admin else "Não" }}</td>
      <td>
        <form method="post" class="d-flex gap-2 align-items-center">
          <input type="hidden" name="username" value="{{ usuario }}" />
          <input
            type="password"
            name="password"
            placeholder="Nova senha"
            class="form-control form-control-sm"
            style="max-width: 200px;"
            required
          />
          <div class="form-check form-switch ms-2">
            <input
              class="form-check-input"
              type="checkbox"
              name="is_admin"
              id="adminSwitch_{{ loop.index }}"
              {% if is_admin %}checked{% endif %}
            />
            <label class="form-check-label" for="adminSwitch_{{ loop.index }}">
              Admin
            </label>
          </div>
          <button type="submit" name="action" value="edit" class="btn btn-sm btn-success ms-2">
            Atualizar
          </button>
          {% if usuario != 'admin' %}
          <button
            type="submit"
            name="action"
            value="delete"
            class="btn btn-sm btn-danger ms-2"
            onclick="return confirm('Confirma exclusão do usuário {{ usuario }}?')"
          >
            Excluir
          </button>
          {% endif %}
        </form>
      </td>
    </tr>
    {% else %}
    <tr>
      <td colspan="3" class="text-center">Nenhum usuário cadastrado.</td>
    </tr>
    {% endfor %}
  </tbody>
</table>

<h4 class="mt-5">Adicionar Novo Usuário</h4>
<form method="post" class="row g-2 align-items-center">
  <input type="hidden" name="action" value="add" />
  <div class="col-auto">
    <input
      type="text"
      name="username"
      placeholder="Usuário"
      class="form-control"
      required
    />
  </div>
  <div class="col-auto">
    <input
      type="password"
      name="password"
      placeholder="Senha"
      class="form-control"
      required
    />
  </div>
  <div class="col-auto form-check form-switch">
    <input
      class="form-check-input"
      type="checkbox"
      name="is_admin"
      id="isAdminNewUser"
    />
    <label class="form-check-label" for="isAdminNewUser">Admin</label>
  </div>
  <div class="col-auto">
    <button type="submit" class="btn btn-primary">Adicionar</button>
  </div>
</form>

{% endblock %}
